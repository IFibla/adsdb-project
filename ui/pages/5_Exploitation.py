import streamlit as st
import pandas as pd
import sys
import os

st.title("Exploitation")

st.warning(
    "As we are working with sample dataset is is normal to find null values in layers like Trusted or Exploitation."
)

st.header("Motor Vehicle Collisions Rating By Brand")

st.markdown(
    """
In this step, four datasets related to motor vehicle collisions and vehicle safety ratings are merged to create 
a unified DataFrame for analysis. The datasets are `mvc_crash`, `mvc_person`, `mvc_vehicles`, and `nhtsa_safety_rating`. 
The layer retrieves these datasets as DataFrames and performs inner joins on the `collision_id` column to combine 
`mvc_crash`, `mvc_person`, and `mvc_vehicles` into a single DataFrame.

Next, the layer processes the `nhtsa_safety_rating` DataFrame by converting the `make` column to lowercase for 
consistency and calculating the average `overall_rating` for each vehicle make. It then merges this safety ratings 
DataFrame with the combined collision DataFrame on the vehicle make columns (`"vehicle_make"` and `"make"`). After 
merging, it filters out any rows with missing `overall_rating` values to ensure data integrity. The final DataFrame, 
`mvc_sr_df`, contains detailed collision data linked with average safety ratings of the vehicle brands involved, 
enabling analysis of the relationship between vehicle safety ratings and collision outcomes.
"""
)

st.write("# Safety Rating by Brand")
st.markdown(
    """
This dataset includes columns such as `vehicle_make`, `vehicle_year`, `number_of_persons_injured`, `number_of_persons_killed`, 
and `overall_rating`. It appears to capture safety ratings across various car brands and model years, with additional 
metrics on injuries and fatalities. This data allows for analysis of the relationship between car brand, model year, 
and safety outcomes. For example, it could be used to identify trends in safety ratings over time for each brand, 
examine which brands and model years are associated with higher injury or fatality rates, and explore if specific 
brands consistently perform better in terms of safety.
"""
)

st.dataframe(pd.read_csv("./sample_tables/mvc_safety_rating_by_brand.csv"))

st.write("# Safety Rating by Accidents")
st.markdown(
    """
This dataset provides information on individual accident cases, including `person_id`, `person_age`, `person_sex`, 
`vehicle_make`, `vehicle_year`, and `overall_rating`. This data can be used to analyze demographics in vehicle safety 
incidents, examining if certain age groups or genders are more likely to be involved in accidents with vehicles of 
specific ratings. Additionally, it can explore whether vehicles with different safety ratings have distinct outcomes 
across different demographics, potentially identifying which brands or models are safer for particular age groups. 
"""
)
st.dataframe(pd.read_csv("./sample_tables/safety_rating_by_accidents.csv"))
